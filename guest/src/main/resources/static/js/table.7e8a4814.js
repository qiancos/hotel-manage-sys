(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["table"],{"2fe1":function(e,t,o){"use strict";o("fbf1")},"365c":function(e,t,o){"use strict";var a=o("bc3a"),l=o.n(a),s=l.a.create({timeout:5e3});s.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject()})),s.interceptors.response.use((function(e){if(200===e.status)return e.data;Promise.reject()}),(function(e){return console.log(e),Promise.reject()}))},"3e92":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"crumbs"},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",[o("i",{staticClass:"el-icon-lx-friend"}),e._v(" 客户列表\n            ")])],1)],1),o("div",{staticClass:"container"},[o("div",{staticClass:"handle-box"},[o("el-button",{staticClass:"handle-del mr10",attrs:{round:"",plain:"",type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v("批量删除\n            ")]),o("el-button",{attrs:{type:"primary",round:"",plain:"",icon:"el-icon-plus"},on:{click:e.handGuest}},[e._v("添加客户")]),e._v("\n               \n            "),o("el-input",{staticClass:"handle-input mr10",attrs:{round:"",placeholder:"可根据姓名,身份证号,联系方式查询",clearable:"","prefix-icon":"el-icon-search"},on:{clear:e.handleSearch},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),o("el-table",{staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),o("el-table-column",{attrs:{prop:"name",label:"用户名",align:"center"}}),o("el-table-column",{attrs:{prop:"roomId",label:"房间号",align:"center"}}),o("el-table-column",{attrs:{prop:"idCard",label:"身份证号",align:"center"}}),o("el-table-column",{attrs:{prop:"contact",label:"联系方式",align:"center"}}),o("el-table-column",{attrs:{label:"状态",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.state?o("el-tag",{attrs:{type:1===t.row.state?"success":0===t.row.state?"danger":""}},[e._v("已入住\n                    ")]):e._e(),-1===t.row.state?o("el-tag",{attrs:{type:11===t.row.state?"success":0===t.row.state?"danger":""}},[e._v("已退房\n                    ")]):e._e(),0===t.row.state?o("el-tag",{attrs:{type:11===t.row.state?"success":0===t.row.state?"danger":""}},[e._v("未处理\n                    ")]):e._e()]}}])}),o("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(o){return e.handleEdit(t.$index,t.row,t.row.name,t.row.idCard,t.row.contact)}}},[e._v("编辑\n                    ")]),o("el-button",{attrs:{plain:"",size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(o){return e.handleDelete(t.$index,t.row,t.row.idCard)}}},[e._v("删除\n                    ")])]}}])})],1),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.guestMsgs.pageIndex,"page-size":e.guestMsgs.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1),o("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[o("el-form-item",{attrs:{label:"身份证号"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.form.idCard,callback:function(t){e.$set(e.form,"idCard",t)},expression:"form.idCard"}})],1),o("el-form-item",{attrs:{label:"用户名"}},[o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"联系电话"}},[o("el-input",{model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"添加用户",visible:e.addVisible,width:"30%"},on:{"update:visible":function(t){e.addVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[o("el-form-item",{attrs:{label:"用户名"}},[o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"身份证号"}},[o("el-input",{model:{value:e.form.idCard,callback:function(t){e.$set(e.form,"idCard",t)},expression:"form.idCard"}})],1),o("el-form-item",{attrs:{label:"联系电话"}},[o("el-input",{model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.saveGuest}},[e._v("确 定")])],1)],1)],1)},l=[],s=(o("7f7f"),o("386d"),o("365c"),{name:"BaseTable",data:function(){return{guestMsgs:{idCard:"",name:"",contact:"",state:"",roomId:"",pageIndex:1,pageSize:10},search:"",tableData:[],multipleSelection:[],delList:[],pageTotal:50,idx:-1,id:-1,editVisible:!1,addVisible:!1,form:{idCard:"",name:"",contact:""}}},created:function(){this.getAllGuest()},methods:{handleSearch:function(){var e=this;console.log(this.search),this.$http.get("http://localhost//getGuestByContact?contact="+this.search).then((function(t){200===t.data.code?e.tableData=t.data.data.guestMsgs:e.$http.get("http://localhost//getGuestByIdCard?idCard="+e.search).then((function(t){200===t.data.code?e.tableData=t.data.data.guestMsgs:e.$http.get("http://localhost//getGuestByName?name="+e.search).then((function(t){200===t.data.code?e.tableData=t.data.data.guestMsgs:e.$message.error("抱歉没有该数据")}))}))}))},getAllGuest:function(){var e=this;this.$http.get("http://localhost/getAllGuest").then((function(t){e.tableData=t.data.data.guestMsgs}))},handGuest:function(){this.addVisible=!0,this.form={}},saveGuest:function(){var e=this;this.$http.post("http://localhost/addGuest?contact="+this.form.contact+"&idCard="+this.form.idCard+"&name="+this.form.name).then((function(t){200===t.data.code?(e.$message.success("添加成功"),e.addVisible=!1,e.getAllGuest(),e.form={}):e.$message.warning("添加失败")}))},handleEdit:function(e,t){this.idx=e,this.form=t,this.editVisible=!0},saveEdit:function(){var e=this;this.$http.post("http://localhost/addGuest?contact="+this.form.contact+"&idCard="+this.form.idCard+"&name="+this.form.name).then((function(t){200===t.data.code?(e.$message.success("修改成功"),e.editVisible=!1,e.getAllGuest(),e.form={}):e.$message.warning("修改失败")}))},handleDelete:function(e,t,o){var a=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){a.$http.delete("http://localhost//deleteGuest?idCard="+o).then((function(t){200===t.data.code?(a.$message.success("删除成功"),a.tableData.splice(e,1),a.getAllGuest()):a.$message.warning("删除失败")}))})).catch((function(){}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){var e=this.multipleSelection.length,t="";this.delList=this.delList.concat(this.multipleSelection);for(var o=0;o<e;o++)t+=this.multipleSelection[o].name+" ";this.$message.error("删除了 ".concat(t)),this.multipleSelection=[]},handlePageChange:function(e){this.$set(this.guestMsgs,"pageIndex",e),this.getData()}}}),n=s,i=(o("2fe1"),o("2877")),r=Object(i["a"])(n,a,l,!1,null,"961aade0",null);t["default"]=r.exports},"474a":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"crumbs"},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",[o("i",{staticClass:"el-icon-school"}),e._v(" 房间列表\n            ")])],1)],1),o("div",{staticClass:"container"},[o("div",{staticClass:"handle-box"},[o("el-button",{attrs:{plain:"",round:"",type:"primary",icon:"el-icon-s-promotion"},on:{click:e.getAllRooms}},[e._v("所有房间")]),e._v("\n             \n            "),o("el-dropdown",[o("el-button",{attrs:{type:"primary",round:"",plain:""}},[e._v("\n                    更多操作"),o("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{nativeOn:{click:function(t){return e.getHasBookedRoom(t)}}},[e._v("已预定房间")]),o("el-dropdown-item",{nativeOn:{click:function(t){return e.getHasCheckedRoom(t)}}},[e._v("已入住房间")]),o("el-dropdown-item",{nativeOn:{click:function(t){return e.getNUllRooms(t)}}},[e._v("剩余空房间")])],1)],1),e._v("\n\n\n              \n            "),o("el-input",{staticClass:"handle-input mr10",attrs:{round:"",placeholder:"请输入房间号搜索,直接回车即可",clearable:"","prefix-icon":"el-icon-search"},on:{clear:e.handleSearch},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.roomMsgs.roomId,callback:function(t){e.$set(e.roomMsgs,"roomId",t)},expression:"roomMsgs.roomId"}}),o("el-button",{staticStyle:{float:"right"},attrs:{plain:"",round:"",type:"primary",icon:"el-icon-plus"},on:{click:e.handBook}},[e._v("添加房间")])],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[o("el-table-column",{attrs:{prop:"roomId",label:"房间号",align:"center",width:"150"}}),o("el-table-column",{attrs:{prop:"rank",label:"房间级别",align:"center",width:"150"}}),o("el-table-column",{attrs:{prop:"size",label:"房间大小",align:"center",width:"150"}}),o("el-table-column",{attrs:{prop:"maxNum",label:"容纳人数",align:"center",width:"150"}}),o("el-table-column",{attrs:{prop:"rent",label:"房间单价",align:"center",width:"150"}}),o("el-table-column",{attrs:{prop:"earnest",label:"房间定金",align:"center",width:"150"}}),o("el-table-column",{attrs:{prop:"position",label:"房间位置",align:"center",width:"150"}}),o("el-table-column",{attrs:{label:"房间状态",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.state?o("el-tag",{attrs:{type:1===t.row.state?"success":0===t.row.state?"danger":""}},[e._v("已入住\n                    ")]):e._e(),-1===t.row.state?o("el-tag",{attrs:{type:11===t.row.state?"success":-1===t.row.state?"danger":""}},[e._v("空房\n                    ")]):e._e(),0===t.row.state?o("el-tag",{attrs:{type:11===t.row.state?"success":9===t.row.state?"danger":""}},[e._v("已预订\n                    ")]):e._e()]}}])}),o("el-table-column",{attrs:{label:"时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-time"}),o("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.time))])]}}])}),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["admin"===e.name?o("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(o){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑\n                    ")]):e._e(),"admin"===e.name?o("el-button",{attrs:{plain:"",size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(o){return e.handleDelete(t.$index,t.row,t.row.roomId)}}},[e._v("删除\n                    ")]):e._e(),"admin"!==e.name?o("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-coffee-cup"},on:{click:function(o){return e.handleService(t.row.roomId)}}},[e._v("消费\n                    ")]):e._e(),"admin"!==e.name?o("el-button",{attrs:{plain:"",size:"mini",type:"success",icon:"el-icon-chat-round"},on:{click:function(o){return e.inspect(t.row.roomId)}}},[e._v("结算\n                    ")]):e._e(),"admin"!==e.name?o("el-button",{attrs:{plain:"",icon:"el-icon-lx-exit",type:"primary"},on:{click:function(o){return e.checkOut(t.row.roomId)}}},[e._v("退房\n                    ")]):e._e()]}}])})],1),o("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[o("el-form-item",{attrs:{label:"房间号",prop:"roomId"}},[o("el-input",{model:{value:e.form.roomId,callback:function(t){e.$set(e.form,"roomId",t)},expression:"form.roomId"}})],1),o("el-form-item",{attrs:{label:"房间级别"}},[o("el-input",{model:{value:e.form.rank,callback:function(t){e.$set(e.form,"rank",t)},expression:"form.rank"}})],1),o("el-form-item",{attrs:{label:"房间大小",prop:"size"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.size,callback:function(t){e.$set(e.form,"size",t)},expression:"form.size"}})],1),o("el-form-item",{attrs:{label:"容纳人数",prop:"maxNum"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.maxNum,callback:function(t){e.$set(e.form,"maxNum",t)},expression:"form.maxNum"}})],1),o("el-form-item",{attrs:{label:"房间单价",prop:"rent"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.rent,callback:function(t){e.$set(e.form,"rent",t)},expression:"form.rent"}})],1),o("el-form-item",{attrs:{label:"房间定金",prop:"earnest"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.earnest,callback:function(t){e.$set(e.form,"earnest",t)},expression:"form.earnest"}})],1),o("el-form-item",{attrs:{label:"房间位置"}},[o("el-input",{model:{value:e.form.position,callback:function(t){e.$set(e.form,"position",t)},expression:"form.position"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.saveRoomEdit}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"添加",visible:e.addVisible,width:"30%"},on:{"update:visible":function(t){e.addVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[o("el-form-item",{attrs:{label:"房间号",prop:"roomId"}},[o("el-input",{model:{value:e.form.roomId,callback:function(t){e.$set(e.form,"roomId",t)},expression:"form.roomId"}})],1),o("el-form-item",{attrs:{label:"房间级别"}},[o("el-input",{model:{value:e.form.rank,callback:function(t){e.$set(e.form,"rank",t)},expression:"form.rank"}})],1),o("el-form-item",{attrs:{label:"房间大小",prop:"size"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.size,callback:function(t){e.$set(e.form,"size",t)},expression:"form.size"}})],1),o("el-form-item",{attrs:{label:"容纳人数",prop:"maxNum"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.maxNum,callback:function(t){e.$set(e.form,"maxNum",t)},expression:"form.maxNum"}})],1),o("el-form-item",{attrs:{label:"房间单价",prop:"rent"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.rent,callback:function(t){e.$set(e.form,"rent",t)},expression:"form.rent"}})],1),o("el-form-item",{attrs:{label:"房间定金",prop:"earnest"}},[o("el-input",{attrs:{placeholder:"请输入正整数"},model:{value:e.form.earnest,callback:function(t){e.$set(e.form,"earnest",t)},expression:"form.earnest"}})],1),o("el-form-item",{attrs:{label:"房间位置"}},[o("el-input",{model:{value:e.form.position,callback:function(t){e.$set(e.form,"position",t)},expression:"form.position"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.saveRoom}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"消费结算",visible:e.inspectVisible,width:"30%"},on:{"update:visible":function(t){e.inspectVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[o("el-form-item",{attrs:{label:"总消费"}},[o("el-input",{model:{value:e.form.toll,callback:function(t){e.$set(e.form,"toll",t)},expression:"form.toll"}})],1),o("el-form-item",{attrs:{label:"已支付"}},[o("el-input",{model:{value:e.form.hasSettle,callback:function(t){e.$set(e.form,"hasSettle",t)},expression:"form.hasSettle"}})],1),o("el-form-item",{attrs:{label:"待支付"}},[o("el-input",{model:{value:e.form.needSettle,callback:function(t){e.$set(e.form,"needSettle",t)},expression:"form.needSettle"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.inspectVisible=!1}}},[e._v("取消支付")]),o("el-button",{attrs:{type:"primary"},on:{click:e.surePay}},[e._v("确认支付")])],1)],1),o("el-dialog",{attrs:{title:"服务列表",visible:e.serviceVisible,width:"30%"},on:{"update:visible":function(t){e.serviceVisible=t}}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.serviceData,border:""}},[o("el-table-column",{attrs:{prop:"id",label:"消费编号",align:"center"}}),o("el-table-column",{attrs:{prop:"name",label:"消费名称",align:"center"}}),o("el-table-column",{attrs:{prop:"money",label:"消费金额",align:"center"}}),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-coffee-cup"},on:{click:function(o){return e.sureCost(t.row.id)}}},[e._v("订购\n                        ")])]}}])})],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.serviceVisible=!1}}},[e._v("订购完成")])],1)],1),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.roomMsgs.pageIndex,"page-size":e.roomMsgs.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1)])},l=[],s=(o("7f7f"),{name:"Room",data:function(){return{name:localStorage.getItem("ms_username"),roomMsgs:{roomId:"",size:"",rank:"",rent:"",earnest:"",maxNum:"",position:"",time:"",pageIndex:1,pageSize:10},costTypes:{id:"",name:"",money:"",serviceNeedRooId:""},value:"",serviceData:[],tableData:[],multipleSelection:[],delList:[],flag:!1,switchValue:!0,editVisible:!1,addVisible:!1,inspectVisible:!1,serviceVisible:!1,pageTotal:50,form:{roomIdPay:"",hasSettle:"",toll:"",needSettle:""},idx:-1,id:-1,rules:{size:[{required:!0,message:"请输入正整数",trigger:"blur"}],maxNum:[{required:!0,message:"请输入正整数",trigger:"blur"}],earnest:[{required:!0,message:"请输入正整数",trigger:"blur"}],rent:[{required:!0,message:"请输入正整数",trigger:"blur"}]}}},created:function(){this.getAllRooms()},methods:{sureCost:function(e){var t=this;console.log("costTypesId: "+e),console.log("serviceNeedRooId: "+this.costTypes.serviceNeedRooId),this.$http.post("http://localhost/addCost?costTypeId="+e+"&id=0&roomId="+this.costTypes.serviceNeedRooId).then((function(e){console.log(e),200===e.data.code?t.$message.success("订购成功！"):t.$message.error("订购失败")}))},getAllCostType:function(){var e=this;this.$http.get("http://localhost/getAllCostType").then((function(t){e.serviceData=t.data.data.costTypes}))},handleService:function(e){this.costTypes.serviceNeedRooId=e,this.serviceVisible=!0,this.getAllCostType()},surePay:function(){var e=this;console.log(this.form.roomIdPay),this.$http.post("http://localhost/settleCostByRoomId?roomId="+this.form.roomIdPay).then((function(t){console.log(t),200===t.data.code?(e.$message.success("结算成功！"),e.inspectVisible=!1,e.form={}):e.$message.error("结算失败")}))},inspect:function(e){var t=this;this.form.roomIdPay=e,this.inspectVisible=!0,this.$http.post("http://localhost/getCostByRoomId?roomId="+e).then((function(e){t.form.hasSettle=e.data.data.hasSettle,t.form.toll=e.data.data.toll,t.form.needSettle=e.data.data.needSettle}))},checkOut:function(e){var t=this;this.$http.post("http://localhost/checkOut?roomId="+e).then((function(e){console.log(e),200===e.data.code?(t.$message.success("您已退房成功！"),t.getAllRooms(),t.form={}):t.$message.error("消费未结清退房失败")}))},getAllRooms:function(){var e=this;this.$http.get("http://localhost/getAllRooms").then((function(t){e.tableData=t.data.data.roomMsgs}))},saveRoomEdit:function(){var e=this;this.form.maxNum>0&&this.form.earnest>0&&this.form.rent>0&&this.form.size>0?this.$http.post("http://localhost/addRoom?earnest="+this.form.earnest+"&roomId="+this.form.roomId+"&maxNum="+this.form.maxNum+"&rank="+this.form.rank+"&rent="+this.form.rent+"&size="+this.form.size+"&position="+this.form.position).then((function(t){200===t.data.code?(e.$message.success("修改成功"),e.editVisible=!1,e.getAllRooms(),e.form={}):e.$message.warning("修改失败")})):this.$message.warning("请检查输入数值是否正确")},saveRoom:function(){var e=this;this.form.maxNum>0&&this.form.earnest>0&&this.form.rent>0&&this.form.size>0?this.$http.post("http://localhost/addRoom?earnest="+this.form.earnest+"&roomId="+this.form.roomId+"&maxNum="+this.form.maxNum+"&rank="+this.form.rank+"&rent="+this.form.rent+"&size="+this.form.size+"&position="+this.form.position).then((function(t){200===t.data.code?(e.$message.success("添加成功"),e.addVisible=!1,e.getAllRooms(),e.form={}):e.$message.warning("添加失败")})):this.$message.warning("请检查输入数值是否正确")},handleDelete:function(e,t,o){var a=this;"admin"===localStorage.getItem("ms_username")?this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){a.$http.delete("http://localhost//deleteRoom?id="+o).then((function(t){200===t.data.code?(a.$message.success("删除成功"),a.tableData.splice(e,1),a.getAllRooms()):a.$message.warning("删除失败")}))})).catch((function(){})):this.$message.error("抱歉您没有该权限")},handBook:function(){"admin"===localStorage.getItem("ms_username")?(this.addVisible=!0,this.form={}):this.$message.error("抱歉您没有该权限")},saveBook:function(){var e=this;this.$http.post("http://localhost/addGuest?contact="+this.form.contact+"&idCard="+this.form.idCard+"&name="+this.form.name).then((function(t){200===t.data.code?(e.$message.success("添加成功"),e.addVisible=!1,e.getAllRooms(),e.form={}):e.$message.warning("添加失败")}))},handleEdit:function(e,t){"admin"===localStorage.getItem("ms_username")?(this.idx=e,this.form=t,this.editVisible=!0):this.$message.error("抱歉您没有该权限")},handleSearch:function(){var e=this;this.$http.get("http://localhost/getRoomById?id="+this.roomMsgs.roomId).then((function(t){if(200===t.data.code){var o=[];o.push(t.data.data.room),e.tableData=o}else e.$message.error("抱歉没有该数据")}))},getNUllRooms:function(){var e=this;this.$http.get("http://localhost/getNullRooms").then((function(t){null===t.data.data?e.$message.info("没有剩余房间了"):(console.log(t),e.tableData=t.data.data.nullRooms)}))},getHasBookedRoom:function(){var e=this;this.$http.get("http://localhost/getHasBookedRoom").then((function(t){null===t.data.data?e.$message.info("已预订房间为空"):(console.log(t),e.tableData=t.data.data.roomMsgs)}))},getHasCheckedRoom:function(){var e=this;this.$http.get("http://localhost/getHasCheckedRoom").then((function(t){null===t.data.data?e.$message.info("已入住房间为空"):(console.log(t),e.tableData=t.data.data.roomMsgs)}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){var e=this.multipleSelection.length,t="";this.delList=this.delList.concat(this.multipleSelection);for(var o=0;o<e;o++)t+=this.multipleSelection[o].roomId+" ";this.$message.error("删除了".concat(t)),this.multipleSelection=[]},handlePageChange:function(e){this.$set(this.roomMsgs,"pageIndex",e),this.getAllRooms()}}}),n=s,i=(o("b516"),o("2877")),r=Object(i["a"])(n,a,l,!1,null,"5a06a8bb",null);t["default"]=r.exports},b516:function(e,t,o){"use strict";o("c5d7")},c5d7:function(e,t,o){},ce06:function(e,t,o){},cfae:function(e,t,o){"use strict";o("ce06")},f52e:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"crumbs"},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",[o("i",{staticClass:"el-icon-lx-addressbook"}),e._v(" 预定列表\n            ")])],1)],1),o("div",{staticClass:"container"},[o("div",{staticClass:"handle-box"},[o("el-button",{staticClass:"handle-del mr10",attrs:{round:"",plain:"",type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v("批量删除\n            ")]),o("el-button",{attrs:{plain:"",round:"",type:"primary",icon:"el-icon-s-home"},on:{click:e.handCheckIn}},[e._v("直接入住")]),e._v("\n\n              \n            "),o("el-input",{staticClass:"handle-input mr10",attrs:{round:"",placeholder:"请输入身份证号搜索,直接回车即可",clearable:"","prefix-icon":"el-icon-search"},on:{clear:e.handleSearch},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.bookMsgs.guestIdCard,callback:function(t){e.$set(e.bookMsgs,"guestIdCard",t)},expression:"bookMsgs.guestIdCard"}}),o("el-button",{staticStyle:{float:"right"},attrs:{plain:"",round:"",type:"primary",icon:"el-icon-plus"},on:{click:e.handBook}},[e._v("添加预定")])],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[o("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),o("el-table-column",{attrs:{prop:"guestIdCard",label:"身份证号",align:"center",width:"200"}}),o("el-table-column",{attrs:{prop:"resultRoom",label:"房间号",align:"center",width:"200"}}),o("el-table-column",{attrs:{prop:"rank",label:"预定房间级别",align:"center",width:"200"}}),o("el-table-column",{attrs:{label:"预计入住时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-time"}),o("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.fromTime))])]}}])}),o("el-table-column",{attrs:{label:"预计退房时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-time"}),o("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.toTime))])]}}])}),o("el-table-column",{attrs:{label:"状态",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[11===t.row.state?o("el-tag",{attrs:{type:11===t.row.state?"success":0===t.row.state?"danger":""}},[e._v("已入住\n                    ")]):e._e(),1===t.row.state?o("el-tag",{attrs:{type:11===t.row.state?"success":0===t.row.state?"danger":""}},[e._v("已处理\n                    ")]):e._e(),0===t.row.state?o("el-tag",{attrs:{type:11===t.row.state?"success":0===t.row.state?"danger":""}},[e._v("未处理\n                    ")]):e._e()]}}])}),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(o){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑\n                    ")]),o("el-button",{attrs:{plain:"",size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(o){return e.handleDelete(t.$index,t.row,t.row.id)}}},[e._v("删除\n                    ")]),o("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-bell",plain:""},on:{click:function(o){return e.handleSolve(t.$index,t.row,t.row.rank)}}},[e._v("处理\n                    ")]),o("el-button",{attrs:{plain:"",type:"success",size:"mini",icon:"el-icon-key"},on:{click:function(o){return e.handleIn(t.row.id)}}},[e._v("入住\n                    ")])]}}])})],1),o("el-dialog",{attrs:{title:"添加",visible:e.addVisible,width:"30%"},on:{"update:visible":function(t){e.addVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[o("el-form-item",{attrs:{label:"用户名"}},[o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"身份证号"}},[o("el-input",{model:{value:e.form.idCard,callback:function(t){e.$set(e.form,"idCard",t)},expression:"form.idCard"}})],1),o("el-form-item",{attrs:{label:"联系电话"}},[o("el-input",{model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}})],1),o("el-form-item",{attrs:{label:"房间级别"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.rank,callback:function(t){e.$set(e.form,"rank",t)},expression:"form.rank"}},e._l(e.types,(function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),o("el-form-item",{attrs:{label:"入住时间"}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"选择日期时间"},model:{value:e.form.fromTime,callback:function(t){e.$set(e.form,"fromTime",t)},expression:" form.fromTime"}})],1),o("el-form-item",{attrs:{label:"退房时间"}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"选择日期时间"},model:{value:e.form.toTime,callback:function(t){e.$set(e.form,"toTime",t)},expression:"form.toTime"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.saveBook}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[o("el-form-item",{attrs:{label:"身份证号"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.form.guestIdCard,callback:function(t){e.$set(e.form,"guestIdCard",t)},expression:"form.guestIdCard"}})],1),o("el-form-item",{attrs:{label:"房间级别"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.rank,callback:function(t){e.$set(e.form,"rank",t)},expression:"form.rank"}},e._l(e.types,(function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),o("el-form-item",{attrs:{label:"入住时间"}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"选择日期时间"},model:{value:e.form.fromTime,callback:function(t){e.$set(e.form,"fromTime",t)},expression:" form.fromTime"}})],1),o("el-form-item",{attrs:{label:"退房时间"}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"选择日期时间"},model:{value:e.form.toTime,callback:function(t){e.$set(e.form,"toTime",t)},expression:"form.toTime"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"处理",visible:e.solveVisible,width:"30%"},on:{"update:visible":function(t){e.solveVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roomTypeData}},[o("el-table-column",{attrs:{prop:"roomId",label:"房型编号",align:"center"}}),o("el-table-column",{attrs:{prop:"rank",label:"房间级别",align:"center"}}),o("el-table-column",{attrs:{prop:"size",label:"房间大小",align:"center"}}),o("el-table-column",{attrs:{prop:"maxNum",label:"容纳人数",align:"center"}}),o("el-table-column",{attrs:{prop:"rent",label:"房间单价",align:"center"}}),o("el-table-column",{attrs:{prop:"earnest",label:"房间定金",align:"center"}})],1),o("br"),o("br"),o("el-form-item",{attrs:{label:"房间级别"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.form.rank,callback:function(t){e.$set(e.form,"rank",t)},expression:"form.rank"}})],1),o("el-form-item",{attrs:{label:"空房间号"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.resultRoom,callback:function(t){e.$set(e.form,"resultRoom",t)},expression:"form.resultRoom"}},e._l(e.optionsByClass,(function(e){return o("el-option",{key:e.roomId,attrs:{label:e.roomId,value:e.roomId}})})),1)],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.solveVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.solveRoomId}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"办理入住",visible:e.checkVisible,width:"32%"},on:{"update:visible":function(t){e.checkVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roomTypeData}},[o("el-table-column",{attrs:{prop:"roomId",label:"房型号",align:"center"}}),o("el-table-column",{attrs:{prop:"rank",label:"房间级别",align:"center"}}),o("el-table-column",{attrs:{prop:"size",label:"房间大小",align:"center"}}),o("el-table-column",{attrs:{prop:"maxNum",label:"容纳人数",align:"center"}}),o("el-table-column",{attrs:{prop:"rent",label:"房间单价",align:"center"}}),o("el-table-column",{attrs:{prop:"earnest",label:"房间定金",align:"center"}})],1),o("br"),o("el-form-item",{attrs:{label:"用户名"}},[o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"身份证号"}},[o("el-input",{model:{value:e.form.idCard,callback:function(t){e.$set(e.form,"idCard",t)},expression:"form.idCard"}})],1),o("el-form-item",{attrs:{label:"联系电话"}},[o("el-input",{model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact",t)},expression:"form.contact"}})],1),o("el-form-item",{attrs:{label:"空房间号"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.resultRoom,callback:function(t){e.$set(e.form,"resultRoom",t)},expression:"form.resultRoom"}},e._l(e.options,(function(e){return o("el-option",{key:e.roomId,attrs:{label:e.roomId,value:e.roomId}})})),1)],1),o("el-form-item",{attrs:{label:"入住时间"}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期时间"},model:{value:e.form.fromTime,callback:function(t){e.$set(e.form,"fromTime",t)},expression:" form.fromTime"}})],1),o("el-form-item",{attrs:{label:"退房时间"}},[o("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期时间"},model:{value:e.form.toTime,callback:function(t){e.$set(e.form,"toTime",t)},expression:"form.toTime"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.checkVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.CheckIn}},[e._v("确 定")])],1)],1),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.bookMsgs.pageIndex,"page-size":e.bookMsgs.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1)])},l=[],s=(o("7f7f"),o("3b2b"),o("a481"),o("ac6a"),o("5df3"),o("4f7f"),o("365c"),{name:"ReserveTable",data:function(){return{time:"hello world",bookMsgs:{id:"",guestIdCard:"",fromTime:"",toTime:"",rank:"",state:"",resultRoom:"",pageIndex:1,pageSize:10},roomTypeData:[],types:[],tableData:[],options:[],optionsByClass:[],multipleSelection:[],delList:[],nullRooms:"",editVisible:!1,addVisible:!1,solveVisible:!1,checkVisible:!1,pageTotal:50,form:{},idx:-1}},created:function(){this.getAllBookMsgs(),this.getNUllRooms(),this.getAllClass(),this.gerAllRooms()},methods:{getNUllRooms:function(){var e=this;this.$http.get("http://localhost/getNullRooms").then((function(t){e.options=t.data.data.nullRooms}))},getAllBookMsgs:function(){var e=this;this.$http.get("http://localhost/getAllBookMsgs").then((function(t){e.tableData=t.data.data.bookMsgs}))},gerAllRooms:function(){var e=this;this.$http.get("http://localhost/getAllRooms").then((function(t){e.roomTypeData=t.data.data.roomMsgs}))},getAllClass:function(){var e=this;this.$http.get("http://localhost/getAllRooms").then((function(t){for(var o=new Set,a=0;a<t.data.data.roomMsgs.length;a++)o.add(t.data.data.roomMsgs[a].rank);e.types=o}))},handBook:function(){this.addVisible=!0,this.form={}},handleDelete:function(e,t,o){var a=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){a.$http.delete("http://localhost//deleteBookMsg?id="+o).then((function(t){200===t.data.code?(a.$message.success("删除成功"),a.tableData.splice(e,1),a.getAllBookMsgs()):a.$message.warning("抱歉您没有该权限")}))})).catch((function(){}))},saveBook:function(){var e=this,t=new Date(this.form.fromTime.replace(new RegExp("-","gm"),"/")).getTime(),o=new Date(this.form.toTime.replace(new RegExp("-","gm"),"/")).getTime();t+=432e5,o+=432e5;var a=Math.floor((o-t)/864e5);console.log(a),console.log("formTime: "+t),console.log("toTime: "+o),a>=1?this.$http.post("http://localhost/addBookMsg?contact="+this.form.contact+"&fromTime="+t+"&id=0&idCard="+this.form.idCard+"&name="+this.form.name+"&toTime="+o+"&rank="+this.form.rank).then((function(t){200===t.data.code?(e.$message.success("添加成功"),e.addVisible=!1,e.getAllBookMsgs(),e.form={}):e.$message.warning("添加失败")})):this.$message.warning("入住时间至少大于1天")},handleEdit:function(e,t){this.idx=e,this.form=t,this.editVisible=!0},saveEdit:function(){var e=this,t=new Date(this.form.fromTime.replace(new RegExp("-","gm"),"/")).getTime(),o=new Date(this.form.toTime.replace(new RegExp("-","gm"),"/")).getTime();t+=432e5,o+=432e5;var a=Math.floor((o-t)/864e5);a>=1?this.$http.put("http://localhost//updateBookMsg?fromTime="+t+"&id="+this.form.id+"&rank="+this.form.rank+"&toTime="+o).then((function(t){200===t.data.code?(e.$message.success("修改成功"),e.editVisible=!1,e.getAllBookMsgs(),e.form={}):e.$message.warning("修改失败")})):this.$message.warning("入住时间至少大于1天")},handCheckIn:function(){this.checkVisible=!0,this.form={}},CheckIn:function(){var e=this,t=new Date(this.form.fromTime.replace(new RegExp("-","gm"),"/")).getTime(),o=new Date(this.form.toTime.replace(new RegExp("-","gm"),"/")).getTime();t+=432e5,o+=432e5;var a=Math.floor((o-t)/864e5);a>=1?this.$http.post("http://localhost/checkIn?contact="+this.form.contact+"&fromTime="+t+"&idCard="+this.form.idCard+"&name="+this.form.name+"&toTime="+o+"&roomId="+this.form.resultRoom).then((function(t){200===t.data.code?(e.$message.success("您已入住成功!"),e.checkVisible=!1,e.getAllBookMsgs(),e.form={}):e.$message.warning("抱歉,入住失败")})):this.$message.warning("入住时间至少大于1天")},handleSolve:function(e,t){var o=this;this.idx=e,this.form=t;var a=new Date(this.form.fromTime.replace(new RegExp("-","gm"),"/")).getTime(),l=new Date(this.form.toTime.replace(new RegExp("-","gm"),"/")).getTime();console.log("formTime: "+a),console.log("toTime: "+l),this.$http.get("http://localhost//getNullRoomsByRank?fromTime="+a+"&rank="+this.form.rank+"&toTime="+l).then((function(e){o.optionsByClass=e.data.data.nullRooms})),this.solveVisible=!0},solveRoomId:function(){var e=this;this.$http.put("http://localhost//assignment?bookMsgId="+this.form.id+"&roomId="+this.form.resultRoom).then((function(t){console.log(t),200===t.data.code?(e.$message.success("分配房间成功"),e.solveVisible=!1,e.getAllBookMsgs(),e.form={}):(e.$message.error("房间类型不匹配，房间失败"),e.solveVisible=!1)}))},handleIn:function(e){var t=this;this.$http.post("http://localhost/bookCheckIn?bookMsgId="+e).then((function(e){200===e.data.code?(t.$message.success("您已入住成功!"),t.editVisible=!1,t.getAllBookMsgs(),t.form={}):t.$message.warning("抱歉,未处理无法入住")}))},handleSearch:function(){var e=this;this.$http.get("http://localhost/getBookMsgByIdCard?idCard="+this.bookMsgs.guestIdCard).then((function(t){console.log(t.data),200===t.data.code?(console.log(t.data.data.bookMsgs),e.tableData=t.data.data.bookMsgs):e.$message.error("抱歉没有该数据")}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){var e=this.multipleSelection.length,t="";this.delList=this.delList.concat(this.multipleSelection);for(var o=0;o<e;o++)t+=this.multipleSelection[o].name+" ";this.$message.error("删除了".concat(t)),this.multipleSelection=[]},handlePageChange:function(e){this.$set(this.bookMsgs,"pageIndex",e),this.getAllBookMsgs()}}}),n=s,i=(o("cfae"),o("2877")),r=Object(i["a"])(n,a,l,!1,null,"1647beca",null);t["default"]=r.exports},fbf1:function(e,t,o){}}]);
//# sourceMappingURL=table.7e8a4814.js.map